# v1.4.0 版本发布说明

## 📅 发布日期
2025年12月1日

## 🎯 版本号
- **Version Code**: 5
- **Version Name**: 1.4.0

## ✨ 主要功能更新

### 1. 默认短信应用支持 🆕

本次更新最重要的功能：**实现成为系统默认短信应用的最小能力**，解决小米14等设备上无法读取所有短信的问题。

#### 核心功能
- ✅ **SMS_DELIVER BroadcastReceiver**：支持作为默认短信应用接收所有短信
- ✅ **短信发送能力（Stub）**：满足系统检查要求
- ✅ **短信写入能力（Stub）**：满足系统检查要求
- ✅ **默认短信应用引导页面**：引导用户设置应用为默认短信应用

#### 新增文件
- `SmsSendService.kt` - 短信发送服务（Stub实现）
- `SmsWriteHelper.kt` - 短信写入辅助工具
- `SmsDefaultAppChecker.kt` - 默认短信应用检查工具
- `DefaultSmsGuideScreen.kt` - 默认短信应用引导页面

#### 修改文件
- `AndroidManifest.xml` - 添加权限和配置
- `SmsReceiver.kt` - 支持SMS_DELIVER，自动识别取件码
- `SettingsScreen.kt` - 集成默认短信应用设置入口

### 2. 权限更新
- 新增 `SEND_SMS` 权限
- 新增 `WRITE_SMS` 权限

### 3. 用户体验改进
- 在设置页面新增"默认短信应用"卡片
- 显示当前是否为默认短信应用状态
- 提供清晰的引导说明和操作入口

---

## 📦 APK文件

### Full版
- **文件名**: `sms-agent-fullRelease-1.4.0.apk`
- **路径**: `android/app/build/outputs/apk/full/release/`
- **大小**: 约 10.66 MB

### Trial版
- **文件名**: `sms-agent-trialRelease-1.4.0-trial.apk`
- **路径**: `android/app/build/outputs/apk/trial/release/`
- **大小**: 约 10.66 MB

---

## 🎯 解决的问题

### 主要问题
- ❌ **问题**：小米14等设备上无法读取所有短信（只能读取白名单短信，如04526开头）
- ✅ **解决**：通过设置为默认短信应用，可以读取所有短信（包括10684开头等）

### 背景
根据用户反馈，在小米14（Android 14/HyperOS）设备上，由于应用不是默认短信应用，系统只放行"白名单短信"（如04526开头的通道短信），其他普通短信（快递/银行/营销/广告）均被屏蔽。

通过实现成为系统默认短信应用的最小能力，应用现在可以：
- 读取所有短信（收件箱 / 发件箱 / 归档）
- 实时接收到短信内容（BroadcastReceiver）
- 自行解析取件码 → 内部展示 → 分类打标签

---

## 📝 使用说明

### 设置默认短信应用

1. 打开应用 → 进入"设置"页面
2. 点击"默认短信应用"卡片
3. 按照引导页面说明，点击"设置为默认短信应用"
4. 在系统设置中选择本应用
5. 完成设置后，应用即可读取所有短信

### 重要说明

- ✅ 不会影响您继续使用微信 / QQ 收发消息
- ✅ 不会修改您的短信内容
- ✅ 仅用于读取短信以识别取件码

---

## 🔗 相关文档

- 需求文档: `docs/改造默认短信.md`
- TODO清单: `docs/DEFAULT_SMS_IMPLEMENTATION_TODO.md`
- 实施总结: `docs/DEFAULT_SMS_IMPLEMENTATION_SUMMARY.md`

---

## ⚠️ 注意事项

1. **首次使用**：需要手动设置为默认短信应用
2. **兼容性**：已在以下环境测试
   - 小米14（HyperOS / Android 14）
   - 小米12/13（MIUI 14）
   - 华为（HarmonyOS 3/4）
   - OPPO/Vivo（Android 13-14）

3. **恢复设置**：如果不再需要，可以在设置页面点击"更改默认短信应用"恢复系统短信应用

---

## 📊 版本对比

| 版本 | 版本号 | 主要特性 |
|------|--------|---------|
| v1.3.0 | 1.3.0 | 基础功能 |
| **v1.4.0** | **1.4.0** | **默认短信应用支持** |

---

## 🔄 升级说明

从 v1.3.0 升级到 v1.4.0：

1. 安装新版本APK
2. 打开应用，进入设置页面
3. 设置为默认短信应用（可选，但推荐）
4. 享受完整功能！

---

**版本**: v1.4.0  
**构建日期**: 2025-12-01  
**开发者**: QuickCode Team

