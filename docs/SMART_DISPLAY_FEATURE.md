# 智能显示功能说明

## 🎯 功能概述

根据短信标签类型，智能提取并显示关键信息，让短信列表更简洁、易读。

---

## 📋 显示规则

### 1. **有标签的短信**
根据标签类型智能提取关键信息：

#### 验证码类
- **标签**：验证码、code、验证
- **提取**：4-8位数字验证码
- **显示**：`验证码: 123456`
- **示例**：
  ```
  发件人: 95533
  关键信息: 验证码: 123456
  标签: 🔐 验证码
  时间: 23小时前
  ```

#### 快递/取件码类
- **标签**：快递、取件、菜鸟驿站
- **提取**：取件码（4-8位字母数字组合）
- **显示**：`取件码: 1234`
- **示例**：
  ```
  发件人: 菜鸟驿站
  关键信息: 取件码: 1234
  标签: 📦 快递
  时间: 2小时前
  ```

#### 银行/金额类
- **标签**：银行、转账、支付
- **提取**：金额、余额
- **显示**：`¥1,234.56 | 余额¥5,678.90`
- **示例**：
  ```
  发件人: 95588
  关键信息: ¥1,234.56 | 余额¥5,678.90
  标签: 🏦 银行
  时间: 1小时前
  ```

### 2. **无标签的短信**
显示内容摘要（前50个字符）：
```
发件人: 10086
内容: 尊敬的客户，您的话费余额不足，请及时充值...
时间: 刚刚
```

---

## 🔍 提取规则

### 验证码提取
支持多种格式：
- `验证码：123456`
- `验证码是123456`
- `code: 123456`
- `您的验证码为123456`

正则表达式：
```javascript
/验证码[：:是为]?\s*(\d{4,8})/
/code[：:is]?\s*(\d{4,8})/i
/(\d{6})/  // 6位纯数字
/(\d{4})/  // 4位纯数字
```

### 取件码提取
支持多种格式：
- `取件码：AB12`
- `提货码是1234`
- `code: A1B2`

正则表达式：
```javascript
/取件码[：:是为]?\s*([A-Z0-9]{4,8})/i
/提货码[：:是为]?\s*([A-Z0-9]{4,8})/i
/([A-Z0-9]{4})/  // 4位字母数字组合
```

### 金额提取
支持多种格式：
- `金额：1,234.56元`
- `转账1234.56元`
- `支付为1234元`

正则表达式：
```javascript
/金额[：:为]?\s*([\d,]+\.?\d*)\s*元/
/转账[：:为]?\s*([\d,]+\.?\d*)\s*元/
/支付[：:为]?\s*([\d,]+\.?\d*)\s*元/
```

### 余额提取
支持多种格式：
- `余额：5,678.90元`
- `可用余额5678元`
- `账户余额为5678.90元`

正则表达式：
```javascript
/余额[：:为]?\s*([\d,]+\.?\d*)\s*元/
/可用余额[：:为]?\s*([\d,]+\.?\d*)\s*元/
/账户余额[：:为]?\s*([\d,]+\.?\d*)\s*元/
```

---

## 💻 技术实现

### 1. 工具函数 (`utils/smsParser.js`)

```javascript
// 提取验证码
export function extractVerificationCode(content)

// 提取取件码
export function extractPickupCode(content)

// 提取金额
export function extractAmount(content)

// 提取余额
export function extractBalance(content)

// 智能提取关键信息
export function extractKeyInfo(content, tags)
```

### 2. 组件使用

```vue
<template>
  <!-- 有标签：显示关键信息 -->
  <div v-if="sms.tags && sms.tags.length > 0" class="sms-key-info">
    <div class="key-info-content">
      {{ getKeyInfo(sms.content, sms.tags) }}
    </div>
    <div class="sms-tags">
      <van-tag>{{ tag.icon }} {{ tag.name }}</van-tag>
    </div>
  </div>
  
  <!-- 无标签：显示摘要 -->
  <div v-else class="sms-body">
    {{ getSummary(sms.content) }}
  </div>
</template>

<script setup>
import { extractKeyInfo } from '@/utils/smsParser'

const getKeyInfo = (content, tags) => {
  const info = extractKeyInfo(content, tags)
  return info.summary || content
}

const getSummary = (content) => {
  return content.length > 50 
    ? content.substring(0, 50) + '...' 
    : content
}
</script>
```

---

## 🎨 样式设计

### 关键信息样式
```css
.key-info-content {
  font-size: 16px;
  font-weight: 600;
  color: #FF6B9D;  /* 粉色突出显示 */
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
```

### 布局
```css
.sms-key-info {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}
```

---

## 📱 显示效果

### 验证码短信
```
┌─────────────────────────────────┐
│ 95533              23小时前      │
│ 验证码: 123456      🔐 验证码    │
└─────────────────────────────────┘
```

### 快递短信
```
┌─────────────────────────────────┐
│ 菜鸟驿站            2小时前      │
│ 取件码: 1234        📦 快递      │
└─────────────────────────────────┘
```

### 银行短信
```
┌─────────────────────────────────┐
│ 95588              1小时前       │
│ ¥1,234.56 | 余额¥5,678.90       │
│                     🏦 银行      │
└─────────────────────────────────┘
```

### 普通短信（无标签）
```
┌─────────────────────────────────┐
│ 10086              刚刚          │
│ 尊敬的客户，您的话费余额不足... │
└─────────────────────────────────┘
```

---

## ✨ 优势

### 1. **信息密度高**
- 一眼看到关键信息
- 减少滚动次数
- 提高查找效率

### 2. **视觉清晰**
- 关键信息粉色突出
- 标签颜色区分
- 布局简洁明了

### 3. **智能识别**
- 自动识别短信类型
- 提取核心内容
- 无需手动操作

### 4. **灵活扩展**
- 易于添加新规则
- 支持自定义提取
- 可配置显示格式

---

## 🔧 扩展方向

### 1. 支持更多类型
- 物流信息（快递单号）
- 会议通知（时间、地点）
- 订单信息（订单号、商品）
- 优惠券（金额、有效期）

### 2. 自定义规则
- 用户自定义提取规则
- 正则表达式配置
- 显示格式自定义

### 3. AI智能提取
- 使用NLP技术
- 语义理解
- 自动分类

---

## 📊 测试案例

### 验证码
```
输入: 【验证码】您的验证码是123456，5分钟内有效。
输出: 验证码: 123456
```

### 取件码
```
输入: 您的快递已到达小区门口，取件码：1234
输出: 取件码: 1234
```

### 银行
```
输入: 您尾号1234的账户转账1,234.56元，余额5,678.90元
输出: ¥1,234.56 | 余额¥5,678.90
```

### 普通
```
输入: 尊敬的客户，您的话费余额不足，请及时充值以免影响使用。
输出: 尊敬的客户，您的话费余额不足，请及时充值以免影响使用。
```

---

## 🎯 使用建议

1. **创建标签时选择合适的名称**
   - 验证码 → 包含"验证"关键词
   - 快递 → 包含"快递"、"取件"关键词
   - 银行 → 包含"银行"、"转账"关键词

2. **为短信添加标签**
   - 系统会自动识别并提取关键信息
   - 标签越准确，提取越精准

3. **查看完整内容**
   - 点击短信卡片查看详情
   - 关键信息只是摘要

---

**功能状态**：✅ 已实现  
**测试状态**：⏳ 待测试  
**优化方向**：持续改进
