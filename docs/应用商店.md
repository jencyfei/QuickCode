# 📄《App 商店体验版（Trial 版）需求文档》

## 一、版本目标

基于现有完整项目（含激活码功能），构建一个 **可在应用商店上架的“体验版 App”**。
体验版用于推广、引流，同时符合商店审核要求，不包含付费引导，也不包含激活码入口。

---

# 1. 版本定位

| 版本类型           | 渠道        | 激活       | 有效期      |
| -------------- | --------- | -------- | -------- |
| **体验版（Trial）** | 各应用商店     | ❌ 无激活码机制 | ✔ 限制 15 天 |
| 完整付费版（Full）    | QQ 群/私域分发 | ✔ 激活码    | 永久       |

体验版主要承担快速获取用户、展示核心价值，提高转化率。

---

# 2. 构建方式

使用 **单项目 + productFlavors** 的方式构建：

* `flavor = trial`
* `applicationIdSuffix = ".trial"`
* `BUILD_CONFIG = IS_TRIAL = true`

体验版与完整版共用代码库，但通过 `BuildConfig.IS_TRIAL` 切换功能。

---

# 3. 功能差异表（最终版）

体验版需要保留你截图里的功能差异，同时新增“15天有效期”。

| 功能点    | 体验版（Trial）                 | 完整版（Full）   |
| ------ | -------------------------- | ----------- |
| 每日识别次数 | **2 次/天**                  | 不限          |
| 历史记录   | **最近 3 条**                 | 全部          |
| 批量操作   | 部分记录                       | 全部          |
| UI 提示  | 保留限制提示                     | 简化 UI，提示最少  |
| 激活机制   | ❌ 隐藏所有激活相关内容               | ✔ 支持激活码绑定设备 |
| 15 天有效期 | ✔ 支持，过期后锁定功能               | ❌ 无限制       |
| 网络权限   | 保留基础权限，不可包含“下载激活码/在线支付”等功能 | 保持当前        |
| 付费引导   | ❌ 不允许                      | ✔ 存在私域付费流程  |

---

# 4. 新增需求：15 天有效期逻辑

### 4.1 记录首次启动时间

体验版首次启动时写入时间戳：

* 存储位置：`SharedPreferences`
* Key：`trial_start_time`

### 4.2 计算剩余天数

剩余天数：`15 - (today - trial_start_time)`

### 4.3 到期处理

到期后：

* 识别按钮禁用
* 历史记录限制为 0
* 批量操作不可用
* 弹出提示：「本体验版已到期，如需继续使用请联系开发者」

符合商店审核的表述（避免敏感词“购买/付费/激活码”）。

---

# 5. 激活机制修改（Trial 版）

体验版需要做到：

### 5.1 隐藏激活入口

需隐藏以下 UI：

* 设置页里的「绑定设备」卡片
* 激活弹窗
* 激活码输入框
* “复制设备 ID” 等相关 UI
* 任何出现“付费/激活/权限/购买”的文字

### 5.2 移除对激活状态的依赖

`ActivationManager.isActivated()` 应在 trial flavor 下 **永远返回 false** 或被替换为 `IS_TRIAL=true` 时的受限逻辑。

### 5.3 避免代码崩溃

需检查：

* `UsageLimitManager`
* `HistoryLimitDialog`
* `DailyLimitDialog`

确保体验版 UI 流程完整。

---

# 6. 体验版限制逻辑 (Trial Logic)

体验版的限制全部改为如下：

| 限制项     | 表现                             |
| ------- | ------------------------------ |
| 每日识别次数  | 2 次/天，由 `UsageLimitManager` 实现 |
| 历史记录    | 只展示最近 3 条                      |
| 批量操作    | 只对展示的 3 条生效                    |
| UI 限制提示 | 允许显示（符合试用产品行为）                 |
| 15 天有效期  | 强制约束，过期后锁定所有功能                 |

---

# 15. App 内文案要求（符合应用商店审核）

### 体验版允许的文案

* “体验版 · 用于功能展示”
* “有效期：15 天”
* “如需技术支持，请联系开发者：xxxxx”
* “部分功能已限制，仅供体验”

### 禁止使用的文案（为了通过审核）

* “购买完整版”
* “扫码付费”
* “激活码”
* “点击联系我购买”
* “请加入 QQ 群付费”
* “永久版下载链接”

**体验版中必须完全移除付费引导。**

---

# 8. 需要新增/调整的界面（Trial 版）

### 8.1 设置页面

展示：

* “当前版本：体验版 Trial”
* “有效期剩余 X 天”
* “技术支持：QQxxxxx / 邮箱xxxxx”

不展示：

* 激活按钮
* 设备 ID
* 激活状态

### 8.2 到期提示弹窗

文案示例：

> 体验版功能已到期
> 如需持续使用本应用，请联系开发者获取帮助。
> 技术支持：xxxxxx

（文案经过审核保护处理）

---

# 9. 包名与图标（商店要求）

### 包名建议（避免与完整版冲突）：

```
com.xxx.express.trial
```

### 图标建议：

* 图标角落标注「体验」或「Trial」

### 应用名称建议：

```
快递取件码助手（体验版）
```

符合商店对试用版命名规范。

---

# 10. 权限与隐私规范

### 必须保留：

* 读取短信权限（核心功能）

### 必须删除：

* 与激活码相关的 file I/O / 网络请求（如有）

### 隐私声明要求：

* 说明数据仅在本地处理，不上传服务器
* 体验版明确说明“无任何联网付费逻辑”

---

# 11. 技术交付清单（程序员要做的事）

| 类型   | 工作内容                           |
| ---- | ------------------------------ |
| 构建   | 使用 productFlavors 生成 trial APK |
| 限制逻辑 | 实现 15 天有效期                      |
| UI   | 隐藏激活入口                         |
| UI   | 新增 Trial 标识与到期提示               |
| 权限   | 去除支付相关权限（如果有）                  |
| 文案   | 覆盖所有“付费/激活/购买”类文字              |
| 测试   | 試用期逻辑、识别次数、历史记录、批量操作、到期锁定      |

---

# 📌 最终说明

你现在的项目结构非常适合：

```
完整版（激活版） → QQ 群私域售卖  
体验版（Trial） → 应用商店上架
```
