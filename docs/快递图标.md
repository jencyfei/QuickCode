# 📄 **需求文档：快递公司图标自动识别与展示功能**

## 1. 背景 / Background

当前 App 在“未取快递列表”中无法直观区分不同快递来源。
用户需要通过短信内容识别是哪家快递，体验较弱。

引入快递公司图标，可提升：

* 信息识别速度
* 卡片可读性
* 产品专业度与可信度
* 整体 UI 美观度

本功能在所有主流快递类应用中均为标配。

---

## 2. 目标 / Objective

在每个未取快递卡片左侧展示对应快递公司的图标，实现以下效果：

* 可根据短信**发件人**或**短信内容关键字**自动匹配快递类型
* 图标离线内置，不依赖网络
* 匹配准确、界面美观、一致性强
* 识别失败时使用默认“箱子 icon”

---

## 3. 功能需求 / Functional Requirements

### 3.1 图标展示位置

* 在未取快递卡片左侧，紧挨卡片主信息区域。
* 图标固定尺寸（见 UI 规范）。
* 图标为单一快递公司的品牌 icon。

### 3.2 匹配逻辑

* App 解析短信列表时，根据短信**发件人号码** + **内容关键字**判断快递公司。
* 最终决定图标显示的字段：`expressType`

### 3.3 图标集合

必须内置以下常见快递图标：

| 快递公司     | 图标文件名             | 图标展示  |
| -------- | ----------------- | ----- |
| 顺丰       | `sf.png`          | SF 红黑 |
| 京东       | `jd.png`          | 京东蓝   |
| 中通       | `zto.png`         | 蓝白    |
| 圆通       | `yto.png`         | 紫色    |
| 申通       | `sto.png`         | 橙色    |
| 菜鸟驿站     | `cainiao.png`     | 蓝色    |
| 丰巢       | `fengchao.png`    | 绿色    |
| 邮政 / EMS | `ems.png`         | 橙蓝    |
| 默认（无法识别） | `default_box.png` | 灰色箱子  |

（可根据 App UI 风格统一处理为面性或线性图标）

---

## 4. 快递识别规则 / Express Recognition Logic

识别流程：

```
1. 优先根据短信发件人判断
2. 若发件人未命中 → 根据短信内容关键字判断
3. 若仍未命中 → 使用 default 图标
```

### 4.1 发件人映射规则

```
SF, 95338 → 顺丰
JD, 950618, 106550618 → 京东
ZTO, 95311 → 中通
YTO, 95554 → 圆通
STO, 95543 → 申通
CAINIAO, 95188 → 菜鸟
```

### 4.2 内容关键字映射规则

| 关键字（contains）       | 快递公司 |
| ------------------- | ---- |
| 顺丰 / SF / 已投柜 / 派送员 | 顺丰   |
| 京东 / JD / 京东快递      | 京东   |
| 中通 / ZTO            | 中通   |
| 圆通 / YTO            | 圆通   |
| 申通 / STO            | 申通   |
| 菜鸟 / 菜鸟驿站           | 菜鸟   |
| 丰巢                  | 丰巢   |
| 邮政 / EMS / 中国邮政     | EMS  |

关键词全部大小写不敏感。

---

## 5. UI 规范 / UI Spec

### 5.1 图标尺寸

* Android：`24dp × 24dp`（可视情况选择 28dp）
* iOS：`24pt × 24pt`
* 保持统一圆角、线粗、留白比例

### 5.2 图标样式

* 建议采用**面性图标（filled）**，颜色遵循对应品牌主色
* 必须保证风格统一

### 5.3 放置位置

* 左侧距卡片边距：`16dp`
* 垂直居中
* 图标右侧与文本间距：`8dp`

---

## 6. 数据结构调整

新增字段：

```
expressType: String  // zto / yto / sf / jd / sto / cainiao / fengchao / ems / default
```

卡片 UI 通过这个字段决定图标显示。

---

## 7. 技术实现方案（建议）

### 7.1 识别模块

新增一个本地模块：

```
ExpressDetector
```

暴露方法：

```
fun detectExpress(sender: String, message: String): String
```

返回 expressType。

### 7.2 本地图标管理

在 `res/drawable` 或 `assets/icons/` 内放置所有图标。

建立映射表：

```
sf -> R.drawable.sf
jd -> R.drawable.jd
...
default -> R.drawable.default_box
```

### 7.3 卡片渲染时加载

```
val iconRes = IconMapper.getIcon(expressType)
imageView.setImageResource(iconRes)
```

---

## 8. 测试点 / QA Checklist

### 8.1 功能测试

* 不同短信自动识别是否正确
* 图标是否正常加载
* 无网络状态下是否正确显示
* 识别失败是否显示 default 图标

### 8.2 边界情况

* 同一家快递不同格式短信
* 空短信 / 特殊字符
* 号码异常（如虚拟号）
* 关键词模糊匹配
* 多条短信匹配一致性

### 8.3 性能

* 列表滑动无卡顿
* 图标加载无延迟
* 不增加 UI 首屏加载时间

---
